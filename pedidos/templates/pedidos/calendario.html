{% extends 'pedidos/base.html' %} 

{% block content %}
<div class="card">
    <div id='calendar'></div>
</div>

<link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/es.global.min.js'></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
        locale: 'es',
        initialView: 'dayGridMonth',
        events: [
            {% for pedido in pedidos %}
            {
                title: '{{ pedido.empresa }} ({{ pedido.cantidad_radios }} radios)',
                start: '{{ pedido.fecha_inicio|date:"Y-m-d" }}',
                end: '{{ pedido.fecha_fin|date:"Y-m-d" }}',
                color: '{% if pedido.estado == "entregado" %}#27ae60{% else %}#f1c40f{% endif %}',
                extendedProps: {
                    guia: '{{ pedido.guia }}',
                    estado: '{{ pedido.estado }}'
                }
            },
            {% endfor %}
        ],
        eventDidMount: function(info) {
            info.el.querySelector('.fc-event-title').insertAdjacentHTML('beforeend', 
                `<br><small>Gu√≠a: ${info.event.extendedProps.guia}</small>`
            );
        }
    });
    calendar.render();
});
</script>
{% endblock %}